<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ecmwfr • ecmwfr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="ecmwfr">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ecmwfr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/ecmwfr_vignette.html">ecmwfr</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/khufkens/ecmwfr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>ecmwfr</h1>
                        <h4 class="author">Koen Hufkens</h4>
            
            <h4 class="date">2019-01-09</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/khufkens/ecmwfr/blob/master/vignettes/ecmwfr_vignette.Rmd"><code>vignettes/ecmwfr_vignette.Rmd</code></a></small>
      <div class="hidden name"><code>ecmwfr_vignette.Rmd</code></div>

    </div>

    
    
<div id="ecmwfr" class="section level1">
<h1 class="hasAnchor">
<a href="#ecmwfr" class="anchor"></a>ecmwfr</h1>
<p>Programmatic interface to the <a href="https://confluence.ecmwf.int/display/WEBAPI/ECMWF+Web+API+Home">‘ECMWF’ web API services</a>. Allows for easy downloads of ECMWF <a href="https://confluence.ecmwf.int/display/WEBAPI/Access+ECMWF+Public+Datasets">public data</a>.</p>
<div id="setup" class="section level2">
<h2 class="hasAnchor">
<a href="#setup" class="anchor"></a>Setup</h2>
<p>Before starting save your provided ECMWF key to your local keychain. In this example I use my R development account with the key hidden using Xs. The package does not allow you to use your key inline in scripts to limit security issues when sharing scripts on github or otherwise.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="co"># set a key to the keychain</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw"><a href="../reference/wf_set_key.html">wf_set_key</a></span>(<span class="dt">email =</span> <span class="st">"khrdev@outlook.com"</span>,</a>
<a class="sourceLine" id="cb1-3" title="3">           <span class="dt">key =</span> <span class="st">"XXXXXXXXXXXXXXXXXXXXXX"</span>)</a>
<a class="sourceLine" id="cb1-4" title="4"></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="co"># you can retrieve the key using</span></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="kw"><a href="../reference/wf_get_key.html">wf_get_key</a></span>(<span class="dt">email =</span> <span class="st">"khrdev@outlook.com"</span>)</a>
<a class="sourceLine" id="cb1-7" title="7"></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="co"># the output should be the key you provided</span></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="co"># in this case represented by the fake X string.</span></a>
<a class="sourceLine" id="cb1-10" title="10"><span class="co"># "XXXXXXXXXXXXXXXXXXXXXX"</span></a></code></pre></div>
<p>Before you can download any data you have to make sure to accept the terms and conditions here: <a href="https://apps.ecmwf.int/datasets/licences/general/">https://apps.ecmwf.int/datasets/licences/general/</a>.</p>
</div>
<div id="listing-ancillary-data" class="section level2">
<h2 class="hasAnchor">
<a href="#listing-ancillary-data" class="anchor"></a>Listing Ancillary data</h2>
<p>You can list ancillary data such as user information, datasets and services using the following calls.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="co"># user info</span></a>
<a class="sourceLine" id="cb2-2" title="2">user_info &lt;-<span class="st"> </span><span class="kw"><a href="../reference/wf_user_info.html">wf_user_info</a></span>(<span class="dt">email =</span> <span class="st">"khrdev@outlook.com"</span>)</a>
<a class="sourceLine" id="cb2-3" title="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(user_info)</a>
<a class="sourceLine" id="cb2-4" title="4"><span class="co">#&gt;   first_name code                uid last_name    full_name</span></a>
<a class="sourceLine" id="cb2-5" title="5"><span class="co">#&gt; 1       Koen  200 khrdev@outlook.com   Hufkens Koen Hufkens</span></a>
<a class="sourceLine" id="cb2-6" title="6"><span class="co">#&gt;                email</span></a>
<a class="sourceLine" id="cb2-7" title="7"><span class="co">#&gt; 1 khrdev@outlook.com</span></a>
<a class="sourceLine" id="cb2-8" title="8"></a>
<a class="sourceLine" id="cb2-9" title="9"><span class="co"># services</span></a>
<a class="sourceLine" id="cb2-10" title="10">services &lt;-<span class="st"> </span><span class="kw"><a href="../reference/wf_services.html">wf_services</a></span>(<span class="dt">email =</span> <span class="st">"khrdev@outlook.com"</span>)</a>
<a class="sourceLine" id="cb2-11" title="11"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(services)</a>
<a class="sourceLine" id="cb2-12" title="12"><span class="co">#&gt;            name                                             url</span></a>
<a class="sourceLine" id="cb2-13" title="13"><span class="co">#&gt; 1      altitude      https://api.ecmwf.int/v1/services/altitude</span></a>
<a class="sourceLine" id="cb2-14" title="14"><span class="co">#&gt; 2        cities        https://api.ecmwf.int/v1/services/cities</span></a>
<a class="sourceLine" id="cb2-15" title="15"><span class="co">#&gt; 3 dummy_epsgram https://api.ecmwf.int/v1/services/dummy_epsgram</span></a>
<a class="sourceLine" id="cb2-16" title="16"><span class="co">#&gt; 4          echo          https://api.ecmwf.int/v1/services/echo</span></a>
<a class="sourceLine" id="cb2-17" title="17"><span class="co">#&gt; 5          mars          https://api.ecmwf.int/v1/services/mars</span></a>
<a class="sourceLine" id="cb2-18" title="18"><span class="co">#&gt; 6     meteogram     https://api.ecmwf.int/v1/services/meteogram</span></a>
<a class="sourceLine" id="cb2-19" title="19"></a>
<a class="sourceLine" id="cb2-20" title="20"><span class="co"># datasets</span></a>
<a class="sourceLine" id="cb2-21" title="21">datasets &lt;-<span class="st"> </span><span class="kw"><a href="../reference/wf_datasets.html">wf_datasets</a></span>(<span class="dt">email =</span> <span class="st">"khrdev@outlook.com"</span>)</a>
<a class="sourceLine" id="cb2-22" title="22"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(datasets)</a>
<a class="sourceLine" id="cb2-23" title="23"><span class="co">#&gt;                    name</span></a>
<a class="sourceLine" id="cb2-24" title="24"><span class="co">#&gt; 1          c3s_seasonal</span></a>
<a class="sourceLine" id="cb2-25" title="25"><span class="co">#&gt; 2 cams_climate_forcings</span></a>
<a class="sourceLine" id="cb2-26" title="26"><span class="co">#&gt; 3           cams_esuite</span></a>
<a class="sourceLine" id="cb2-27" title="27"><span class="co">#&gt; 4             cams_gfas</span></a>
<a class="sourceLine" id="cb2-28" title="28"><span class="co">#&gt; 5   cams_ghg_inversions</span></a>
<a class="sourceLine" id="cb2-29" title="29"><span class="co">#&gt; 6        cams_nrealtime</span></a>
<a class="sourceLine" id="cb2-30" title="30"><span class="co">#&gt;                                                       url</span></a>
<a class="sourceLine" id="cb2-31" title="31"><span class="co">#&gt; 1          https://api.ecmwf.int/v1/datasets/c3s_seasonal</span></a>
<a class="sourceLine" id="cb2-32" title="32"><span class="co">#&gt; 2 https://api.ecmwf.int/v1/datasets/cams_climate_forcings</span></a>
<a class="sourceLine" id="cb2-33" title="33"><span class="co">#&gt; 3           https://api.ecmwf.int/v1/datasets/cams_esuite</span></a>
<a class="sourceLine" id="cb2-34" title="34"><span class="co">#&gt; 4             https://api.ecmwf.int/v1/datasets/cams_gfas</span></a>
<a class="sourceLine" id="cb2-35" title="35"><span class="co">#&gt; 5   https://api.ecmwf.int/v1/datasets/cams_ghg_inversions</span></a>
<a class="sourceLine" id="cb2-36" title="36"><span class="co">#&gt; 6        https://api.ecmwf.int/v1/datasets/cams_nrealtime</span></a></code></pre></div>
</div>
<div id="data-requests" class="section level2">
<h2 class="hasAnchor">
<a href="#data-requests" class="anchor"></a>Data Requests</h2>
<p>To download data use the wf_request() function, together with your email and a request string syntax <a href="https://confluence.ecmwf.int/display/WEBAPI/Brief+request+syntax#Briefrequestsyntax-Syntax">as documented</a>. Instead of <code>json</code> formatting the function uses a simple <code>R</code> list for all the arguments.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="co"># this is an example of a request</span></a>
<a class="sourceLine" id="cb3-2" title="2">my_request &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">stream =</span> <span class="st">"oper"</span>,</a>
<a class="sourceLine" id="cb3-3" title="3">                  <span class="dt">levtype =</span> <span class="st">"sfc"</span>,</a>
<a class="sourceLine" id="cb3-4" title="4">                  <span class="dt">param =</span> <span class="st">"167.128"</span>,</a>
<a class="sourceLine" id="cb3-5" title="5">                  <span class="dt">dataset =</span> <span class="st">"interim"</span>,</a>
<a class="sourceLine" id="cb3-6" title="6">                  <span class="dt">step =</span> <span class="st">"0"</span>,</a>
<a class="sourceLine" id="cb3-7" title="7">                  <span class="dt">grid =</span> <span class="st">"0.75/0.75"</span>,</a>
<a class="sourceLine" id="cb3-8" title="8">                  <span class="dt">time =</span> <span class="st">"00"</span>,</a>
<a class="sourceLine" id="cb3-9" title="9">                  <span class="dt">date =</span> <span class="st">"2014-07-01/to/2014-07-31"</span>,</a>
<a class="sourceLine" id="cb3-10" title="10">                  <span class="dt">type =</span> <span class="st">"an"</span>,</a>
<a class="sourceLine" id="cb3-11" title="11">                  <span class="dt">class =</span> <span class="st">"ei"</span>,</a>
<a class="sourceLine" id="cb3-12" title="12">                  <span class="dt">area =</span> <span class="st">"73.5/-27/33/45"</span>,</a>
<a class="sourceLine" id="cb3-13" title="13">                  <span class="dt">format =</span> <span class="st">"netcdf"</span>,</a>
<a class="sourceLine" id="cb3-14" title="14">                  <span class="dt">target =</span> <span class="st">"tmp.nc"</span>)</a>
<a class="sourceLine" id="cb3-15" title="15"></a>
<a class="sourceLine" id="cb3-16" title="16"><span class="co"># an example download using fw_request()</span></a>
<a class="sourceLine" id="cb3-17" title="17"><span class="co"># using the above request list()</span></a>
<a class="sourceLine" id="cb3-18" title="18"><span class="kw"><a href="../reference/wf_request.html">wf_request</a></span>(</a>
<a class="sourceLine" id="cb3-19" title="19">  <span class="dt">email =</span> <span class="st">"khrdev@outlook.com"</span>,</a>
<a class="sourceLine" id="cb3-20" title="20">  <span class="dt">transfer =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb3-21" title="21">  <span class="dt">path =</span> <span class="st">"~"</span>,</a>
<a class="sourceLine" id="cb3-22" title="22">  <span class="dt">request =</span> my_request,</a>
<a class="sourceLine" id="cb3-23" title="23">  <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p>This operation might take a while. A progress indicator will keep you informed on the status of your request. The download will expire after a default time out of one hour. You will be informed of where to track your job request on <a href="https://apps.ecmwf.int/webmars/joblist/">the ECMWF website</a>, and provided with a download url which can be sued with the <code>wt_transfer()</code> funtion to download the data on a later moment. Keep in mind that you can only have 3 active downloads and 20 job items queued!</p>
<p>If the download is successful you can visualize one layer in the retrieved stack of temperatures at 2 meters using the plotting routine below.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">s &lt;-<span class="st"> </span>raster<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/stack">stack</a></span>(<span class="st">"~/tmp.nc"</span>)</a>
<a class="sourceLine" id="cb4-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(s)</a>
<a class="sourceLine" id="cb4-3" title="3"><span class="co">#&gt; class       : RasterStack </span></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="co">#&gt; dimensions  : 55, 97, 5335, 31  (nrow, ncol, ncell, nlayers)</span></a>
<a class="sourceLine" id="cb4-5" title="5"><span class="co">#&gt; resolution  : 0.75, 0.75  (x, y)</span></a>
<a class="sourceLine" id="cb4-6" title="6"><span class="co">#&gt; extent      : -27.375, 45.375, 32.625, 73.875  (xmin, xmax, ymin, ymax)</span></a>
<a class="sourceLine" id="cb4-7" title="7"><span class="co">#&gt; coord. ref. : +proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0 </span></a>
<a class="sourceLine" id="cb4-8" title="8"><span class="co">#&gt; names       : X2014.07.01.01.50.39, X2014.07.02.01.50.39, X2014.07.03.01.50.39, X2014.07.04.01.50.39, X2014.07.05.01.50.39, X2014.07.06.01.50.39, X2014.07.07.01.50.39, X2014.07.08.01.50.39, X2014.07.09.01.50.39, X2014.07.10.01.50.39, X2014.07.11.01.50.39, X2014.07.12.01.50.39, X2014.07.13.01.50.39, X2014.07.14.01.50.39, X2014.07.15.01.50.39, ...</span></a>
<a class="sourceLine" id="cb4-9" title="9"></a>
<a class="sourceLine" id="cb4-10" title="10">raster<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/plot">plot</a></span>(s[[<span class="dv">1</span>]], <span class="dt">main =</span> <span class="st">"2 meter temperature (Kelvin)"</span>)</a>
<a class="sourceLine" id="cb4-11" title="11">maps<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/maps/topics/map">map</a></span>(<span class="st">"world"</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="ecmwfr_vignette_files/figure-html/unnamed-chunk-4-1.png" width="672"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#ecmwfr">ecmwfr</a><ul class="nav nav-pills nav-stacked">
<li><a href="#setup">Setup</a></li>
      <li><a href="#listing-ancillary-data">Listing Ancillary data</a></li>
      <li><a href="#data-requests">Data Requests</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Koen Hufkens.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.2.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
