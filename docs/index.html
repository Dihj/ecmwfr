<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Interface to 'ECMWF' and 'CDS' Data Web Services • ecmwfr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><link href="extra.css" rel="stylesheet">
<meta property="og:title" content="Interface to 'ECMWF' and 'CDS' Data Web Services">
<meta property="og:description" content="Programmatic interface to the European Centre for Medium-Range
    Weather Forecasts public and restricted dataset web services (ECMWF;
    &lt;https://www.ecmwf.int/&gt;) as well as Copernicus's Climate Data Store (CDS;
    &lt;https://cds.climate.copernicus.eu&gt;).
    Allows for easy downloads of weather forecasts and
    climate data directly to your R work space or your computer.">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">ecmwfr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/ecmwf_vignette.html">ECMWF</a>
    </li>
    <li>
      <a href="articles/cds_vignette.html">CDS</a>
    </li>
    <li class="dropdown-header">Changelog</li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
<li>
  <a href="contact.html">Contact</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/khufkens/ecmwfr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="contents col-md-9">


<div id="ecmwfr" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#ecmwfr" class="anchor"></a>ecmwfr</h1></div>
<p>Programmatic interface to the <a href="https://confluence.ecmwf.int/display/WEBAPI/ECMWF+Web+API+Home">‘ECMWF’ web API services</a>. Allows for easy downloads of ECMWF <a href="http://apps.ecmwf.int/datasets/">public data</a>.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<div id="stable-release" class="section level3">
<h3 class="hasAnchor">
<a href="#stable-release" class="anchor"></a>stable release</h3>
<p>To install the current stable release use a CRAN repository:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/install.packages">install.packages</a></span>(<span class="st">"ecmwfr"</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(<span class="st">"ecmwfr"</span>)</code></pre></div>
</div>
<div id="development-release" class="section level3">
<h3 class="hasAnchor">
<a href="#development-release" class="anchor"></a>development release</h3>
<p>To install the development releases of the package run the following commands:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span>(<span class="op">!</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">require</a></span>(devtools)){<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/install.packages">install.packages</a></span>(<span class="st">"devtools"</span>)}
devtools<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/devtools/topics/reexports">install_github</a></span>(<span class="st">"khufkens/ecmwfr"</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(<span class="st">"ecmwfr"</span>)</code></pre></div>
<p>Vignettes are not rendered by default, if you want to include additional documentation please use:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span>(<span class="op">!</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">require</a></span>(devtools)){<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/install.packages">install.packages</a></span>(<span class="st">"devtools"</span>)}
devtools<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/devtools/topics/reexports">install_github</a></span>(<span class="st">"khufkens/ecmwfr"</span>, <span class="dt">build_vignettes =</span> <span class="ot">TRUE</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(<span class="st">"ecmwfr"</span>)</code></pre></div>
</div>
</div>
<div id="use-ecmwf-services" class="section level2">
<h2 class="hasAnchor">
<a href="#use-ecmwf-services" class="anchor"></a>Use: ECMWF services</h2>
<p>Create a ECMWF account by <a href="https://apps.ecmwf.int/registration/">self registering</a> and retrieving your key at <a href="https://api.ecmwf.int/v1/key/" class="uri">https://api.ecmwf.int/v1/key/</a> after you log in. The key is a long series of numbers and characters (X in the example below).</p>
<div class="sourceCode"><pre class="sourceCode json"><code class="sourceCode json"><span class="fu">{</span>
    <span class="dt">"url"</span>   <span class="fu">:</span> <span class="st">"https://api.ecmwf.int/v1"</span><span class="fu">,</span>
    <span class="dt">"key"</span>   <span class="fu">:</span> <span class="st">"XXXXXXXXXXXXXXXXXXXXXX"</span><span class="fu">,</span>
    <span class="dt">"email"</span> <span class="fu">:</span> <span class="st">"john.smith@example.com"</span>
<span class="fu">}</span></code></pre></div>
<div id="setup" class="section level3">
<h3 class="hasAnchor">
<a href="#setup" class="anchor"></a>Setup</h3>
<p>Before starting save the provided key to your local keychain. The package does not allow you to use your key inline in scripts to limit security issues when sharing scripts on github or otherwise.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># set a key to the keychain</span>
<span class="kw"><a href="reference/wf_set_key.html">wf_set_key</a></span>(<span class="dt">email =</span> <span class="st">"john.smith@example.com"</span>, <span class="dt">key =</span> <span class="st">"XXXXXXXXXXXXXXXXXXXXXX"</span>)

<span class="co"># you can retrieve the key using</span>
<span class="kw"><a href="reference/wf_get_key.html">wf_get_key</a></span>(<span class="dt">email =</span> <span class="st">"john.smith@example.com"</span>)

<span class="co"># the output should be the key you provided</span>
<span class="co"># "XXXXXXXXXXXXXXXXXXXXXX"</span></code></pre></div>
<p>Before you can download any data you have to make sure to accept the terms and conditions here: <a href="https://apps.ecmwf.int/datasets/licences/general/" class="uri">https://apps.ecmwf.int/datasets/licences/general/</a>.</p>
</div>
<div id="data-requests" class="section level3">
<h3 class="hasAnchor">
<a href="#data-requests" class="anchor"></a>Data Requests</h3>
<p>To download data use the wf_request() function, together with your email and a request string syntax <a href="https://confluence.ecmwf.int/display/WEBAPI/Brief+request+syntax#Briefrequestsyntax-Syntax">as documented</a>. Instead of <code>json</code> formatting the function uses a simple <code>R</code> list for all the arguments.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># this is an example of a request</span>
my_request &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">stream =</span> <span class="st">"oper"</span>,
                   <span class="dt">levtype =</span> <span class="st">"sfc"</span>,
                   <span class="dt">param =</span> <span class="st">"165.128/166.128/167.128"</span>,
                   <span class="dt">dataset =</span> <span class="st">"interim"</span>,
                   <span class="dt">step =</span> <span class="st">"0"</span>,
                   <span class="dt">grid =</span> <span class="st">"0.75/0.75"</span>,
                   <span class="dt">time =</span> <span class="st">"00/06/12/18"</span>,
                   <span class="dt">date =</span> <span class="st">"2014-07-01/to/2014-07-31"</span>,
                   <span class="dt">type =</span> <span class="st">"an"</span>,
                   <span class="dt">class =</span> <span class="st">"ei"</span>,
                   <span class="dt">area =</span> <span class="st">"73.5/-27/33/45"</span>,
                   <span class="dt">format =</span> <span class="st">"netcdf"</span>,
                   <span class="dt">target =</span> <span class="st">"tmp.nc"</span>)

<span class="co"># an example download using fw_request()</span>
<span class="co"># using the above request list()</span>
<span class="co"># </span>
<span class="co"># data will be transferred to disk</span>
<span class="co"># and saved in your home directory (~)</span>
<span class="co"># set by the path argument</span>

<span class="kw"><a href="reference/wf_request.html">wf_request</a></span>(
  <span class="dt">email =</span> <span class="st">"john.smith@example.com"</span>,
  <span class="dt">transfer =</span> <span class="ot">TRUE</span>,
  <span class="dt">path =</span> <span class="st">"~"</span>,
  <span class="dt">request =</span> my_request)</code></pre></div>
<p>This operation might take a while. A progress indicator will keep you informed on the status of your request. Keep in mind that all data downloaded will be buffered in memory limiting the downloads to ~6GB on low end systems.</p>
</div>
</div>
<div id="use-copernicus-climate-data-store-cds" class="section level2">
<h2 class="hasAnchor">
<a href="#use-copernicus-climate-data-store-cds" class="anchor"></a>Use: Copernicus Climate Data Store (CDS)</h2>
<p>Create a free CDS user account by <a href="https://cds.climate.copernicus.eu/user/register">self registering</a>. Once your user account has been verified you can get your personal <em>user ID</em> and <em>key</em> by visiting the <a href="https://cds.climate.copernicus.eu/user">user profile</a>. This information is required to be able to retrieve data via the <code>ecmwfr</code> package. Two different ways to use your login are available: use the <code>ecmwf</code> <a href="references/cds_set_key.html"><code>cds_set_key</code></a> function to store your login information in the system keyring, or store your login information in a file called <code>.cdsapirc</code> located in your user’s home directory. The <code>.cdsapirc</code> file is a simple ASCII file which will look similar to this:</p>
<div class="sourceCode"><pre class="sourceCode json"><code class="sourceCode json"><span class="er">url:</span> <span class="er">https://cds.climate.copernicus.eu/api/v2</span>
<span class="er">key:</span> <span class="er">1234:abcd1234-foo-bar-98765431-XXXXXXXXXX</span></code></pre></div>
<p>More details can be found here: <a href="https://cds.climate.copernicus.eu/api-how-to">How to use the CDS API</a>. The <code>ecmwfr</code> package will also use this file, if preferr to do so (see <a href="references/cds_from_file.html"><code>cds_key_from_file</code></a>).</p>
<div id="setup-1" class="section level3">
<h3 class="hasAnchor">
<a href="#setup-1" class="anchor"></a>Setup</h3>
<p>If you preferr to use your local keychain (rather than using the <code>.cdsapirc</code> file) you have to save your login information first. The package does not allow you to use your key inline in scripts to limit security issues when sharing scripts on github or otherwise.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># set a key to the keychain</span>
<span class="kw">cdf_set_key</span>(<span class="dt">user =</span> <span class="st">"1234"</span>, <span class="dt">key =</span> <span class="st">"1234:abcd1234-foo-bar-98765431-XXXXXXXXXX"</span>)

<span class="co"># you can retrieve the key using</span>
<span class="kw"><a href="reference/cds_get_key.html">cds_get_key</a></span>(<span class="dt">user =</span> <span class="st">"1234"</span>)

<span class="co"># the output should be the key you provided</span>
<span class="co"># "1234:abcd1234-foo-bar-98765431-XXXXXXXXXX"</span></code></pre></div>
<p>Before you can download any data you have to make sure to accept the terms and conditions here: Before downloading and processing data from CDS please make sure you acceppt the terms and conditions which can be found here: <a href="https://cds.climate.copernicus.eu/disclaimer-privacy">Copernicus Climate Data Store Disclaimer/Privacy</a>.</p>
</div>
<div id="data-requests-1" class="section level3">
<h3 class="hasAnchor">
<a href="#data-requests-1" class="anchor"></a>Data Requests</h3>
<p>To download data use the <a href="references/cds_request.html"><code>cds_request</code></a> function, together with your <em>user ID</em> and a request string syntax <a href="https://confluence.ecmwf.int/display/WEBAPI/Brief+request+syntax#Briefrequestsyntax-Syntax">as documented</a>. Instead of <code>json</code> formatting the function uses a simple <code>R</code> list for all the arguments. <strong>Note</strong>: the simplest way to get the requests is to go to the CDS website which offers an interactive interface to create these requests. E.g., for ERA-5 reanalysis:</p>
<ul>
<li><a href="https://cds.climate.copernicus.eu/cdsapp#!/dataset/reanalysis-era5-pressure-levels?tab=form">pressure level data</a></li>
<li><a href="https://cds.climate.copernicus.eu/cdsapp#!/dataset/reanalysis-era5-single-levels?tab=form">surface data</a></li>
<li>…</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># This is an example of a request for # downloading 'ERA-5' reanalysis data for</span>
<span class="co"># 2000-04-04 00:00 UTC, temperature on # 850 hectopascal for an area covering #</span>
northern Europe.
<span class="co"># File will be stored as "era5-demo.nc" (netcdf format).</span>
request &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="st">"dataset"</span> =<span class="st"> "reanalysis-era5-pressure-levels"</span>,
                <span class="st">"product_type"</span> =<span class="st"> "reanalysis"</span>,
                <span class="st">"variable"</span> =<span class="st"> "temperature"</span>,
                <span class="st">"pressure_level"</span> =<span class="st"> "850"</span>,
                <span class="st">"year"</span> =<span class="st"> "2000"</span>,
                <span class="st">"month"</span> =<span class="st"> "04"</span>,
                <span class="st">"day"</span> =<span class="st"> "04"</span>,
                <span class="st">"time"</span> =<span class="st"> "00:00"</span>,
                <span class="st">"area"</span> =<span class="st"> "70/-20/00/60"</span>,
                <span class="st">"format"</span> =<span class="st"> "netcdf"</span>,
                <span class="st">"target"</span> =<span class="st"> "era5-demo.nc"</span>)


<span class="co"># If you have stored your user login information</span>
<span class="co"># in the keyring by calling cds_set_key you can</span>
<span class="co"># call:</span>
file &lt;-<span class="st"> </span><span class="kw"><a href="reference/cds_request.html">cds_request</a></span>(<span class="dt">user     =</span> <span class="st">"1234"</span>,   <span class="co"># user ID (for authentification)</span>
                    <span class="dt">request  =</span> request,  <span class="co"># the request</span>
                    <span class="dt">transfer =</span> <span class="ot">TRUE</span>,     <span class="co"># download the file</span>
                    <span class="dt">path     =</span> <span class="st">"."</span>)      <span class="co"># store data in current working directory</span>

<span class="co"># If you have created a .cdsapirc file in your local</span>
<span class="co"># home directory you can also tell cds_request to use</span>
<span class="co"># the file by setting user = NULL:</span>
file &lt;-<span class="st"> </span><span class="kw"><a href="reference/cds_request.html">cds_request</a></span>(<span class="dt">user     =</span> <span class="ot">NULL</span>,     <span class="co"># use ~/.cdsapirc</span>
                    <span class="dt">request  =</span> request,  <span class="co"># the request</span>
                    <span class="dt">transfer =</span> <span class="ot">TRUE</span>,     <span class="co"># download the file</span>
                    <span class="dt">path     =</span> <span class="st">"."</span>)      <span class="co"># store data in current working directory</span></code></pre></div>
<p>The CDS services are quite fast, however, if you request a lot of variables, multiple levels, and data over several years these requests might take quite a while! <strong>Note</strong>: If you need to download larger amounts of data it is suggested to split the downloads, e.g., download the data in junks (e.g., month-by-month, or year-by-year). A progress indicator will keep you informed on the status of your request. Keep in mind that all data downloaded will be buffered in memory limiting the downloads to ~6GB on low end systems.</p>
</div>
</div>
<div id="acknowledgements" class="section level2">
<h2 class="hasAnchor">
<a href="#acknowledgements" class="anchor"></a>Acknowledgements</h2>
<p>This project was in part supported by the Belgian Science Policy office COBECORE project (BELSPO; grant BR/175/A3/COBECORE) and a “Fonds voor Wetenschappelijk Onderzoek” travel grant (FWO; V438318N).</p>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=ecmwfr">https://​cloud.r-project.org/​package=ecmwfr</a>
</li>
<li>Browse source code at <br><a href="https://github.com/khufkens/ecmwfr">https://​github.com/​khufkens/​ecmwfr</a>
</li>
<li>Report a bug at <br><a href="https://github.com/khufkens/ecmwfr/issues">https://​github.com/​khufkens/​ecmwfr/​issues</a>
</li>
<li>ECMWF Public Datasets at <br><a href="https://apps.ecmwf.int/datasets">https://​apps.ecmwf.int/​datasets</a>
</li>
<li>Copernicus CDS at <br><a href="https://cds.climate.copernicus.eu">https://​cds.climate.copernicus.eu</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/AGPL-3">AGPL-3</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Koen Hufkens <br><small class="roles"> Author, maintainer </small>  </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://travis-ci.org/khufkens/ecmwfr"><img src="https://travis-ci.org/khufkens/ecmwfr.svg?branch=master" alt="Build Status"></a></li>
<li><a href="https://codecov.io/gh/khufkens/ecmwfr"><img src="https://codecov.io/gh/khufkens/ecmwfr/branch/master/graph/badge.svg" alt="codecov"></a></li>
<li><a href="https://cran.r-project.org/package=ecmwwfr"><img src="https://www.r-pkg.org/badges/version/ecmwwfr" alt="CRAN_Status_Badge"></a></li>
<li><a href="https://cran.r-project.org/package=ecmwwfr"><img src="https://cranlogs.r-pkg.org/badges/grand-total/ecmwwfr"></a></li>
<li><a href="https://www.buymeacoffee.com/H2wlgqCLO" target="_blank"><img src="https://www.buymeacoffee.com/assets/img/custom_images/orange_img.png" alt="Buy Me A Coffee" height="21px"></a></li>
</ul>
</div>
</div>
</div>

      <footer><div class="copyright">
  <p>Developed by Koen Hufkens.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.9000.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
